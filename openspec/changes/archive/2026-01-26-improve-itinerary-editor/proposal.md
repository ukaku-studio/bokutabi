# Change: 旅程エディタの改善

## Why

現在のCreateItineraryPageは基本的な旅程作成機能を提供していますが、以下の点でユーザビリティに課題があります：

1. **日付管理が手動** - 連続する予定でも各パネルで日付を手動設定する必要がある
2. **場所検索がモック** - 位置情報モーダルはテキストを受け付けるが、実際の座標取得ができない
3. **金額入力がない** - ItineraryItem型はcostをサポートしているが、UIで入力できない
4. **パネルUIが広すぎ** - 現在のp-4パディングはモバイル画面で無駄が多い
5. **絵文字が手動選択のみ** - 一般的な場所タイプでも手動で絵文字を選ぶ必要がある
6. **日付フィルタリングがない** - 長い旅程は操作しづらい
7. **日付バリデーションがない** - 後のパネルに前の日付を設定できてしまう
8. **プレビュー機能がない** - 共有前に見た目を確認できない
9. **開発環境の保護がない** - Basic認証によるアクセス制限がない
10. **空パネルが保存される** - 未入力のパネルがそのまま保存される
11. **ダークモードの問題** - パスワード入力欄のスタイリングに問題がある

## What Changes

### パネル改善 (CreateItineraryPage.tsx)
- **日付自動継承**: パネルNの日付設定時、パネルN+1以降の日付が未設定または古い場合に自動更新
- **Geocoding統合**: 「設定する」ボタンでGoogle Maps Geocoding APIを呼び出し座標取得
- **金額入力欄**: 任意の金額（数値＋通貨）入力フィールドを追加
- **パディング縮小**: パネルのパディングをp-4からp-2に変更
- **絵文字自動設定**: 場所キーワードに基づき自動設定（空港→✈️、駅→🚃など）、デフォルト📍の場合のみ
- **日付タブ**: タイトル下に「全て」＋各日付のタブバーを追加
- **カレンダー制限**: 前のパネルの日付より前の日付を選択不可に

### 認証・プレビュー
- **Basic認証**: アプリ全体を開発用のユーザー名/パスワードで保護
- **プレビューボタン**: 保存FABの上に「プレビュー」ボタンを追加
- **プレビュー画面**: 整形された読み取り専用ビュー、共有リンクでもアクセス可能
- **編集ボタン**: 共有リンクで自分の旅程を見たとき「編集する」ボタンを表示

### 保存処理
- **空パネル自動削除**: タイトルも場所も空のパネルを保存前に除去

### UI修正
- **パスワード欄修正**: ダークモードでパスワード入力欄に白背景を適用

## Impact

### 影響するスペック
- **itinerary-management** (MODIFIED): 日付処理、金額入力、絵文字自動選択、日付タブ、空パネル削除
- **map-integration** (MODIFIED): 場所確定時のGeocoding呼び出し
- **secure-sharing** (ADDED): Basic認証、プレビュー機能

### 変更対象ファイル
- `src/pages/CreateItineraryPage.tsx` - エディタ全般の改善
- `src/pages/ItineraryPage.tsx` - 編集ボタン追加
- `src/lib/geocoding.ts` (新規) - Geocoding API呼び出し
- `src/pages/PreviewItineraryPage.tsx` (新規) - プレビュー画面
- `src/middleware/BasicAuth.tsx` (新規) - Basic認証コンポーネント
- `src/i18n/locales/*.json` - 翻訳キー追加
- `src/App.tsx` - プレビュールート追加、Basic認証ラッパー
