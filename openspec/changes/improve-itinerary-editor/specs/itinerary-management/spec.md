# Itinerary Management

## ADDED Requirements

### Requirement: 日付フィールドは前のパネルから自動継承される
ユーザーがパネルの日付を設定したとき、後続のパネルに日付がない場合または古い日付の場合、自動的に更新されなければならない（SHALL）。

#### Scenario: 連続パネルへの日付自動継承
- **WHEN** ユーザーがパネルNの日付を設定する
- **AND** パネルN+1に日付が設定されていない
- **THEN** パネルN+1はパネルNの日付を自動的に継承する

#### Scenario: 後の日付が設定されているパネルはスキップ
- **WHEN** ユーザーがパネルNの日付を「2024-12-31」に設定する
- **AND** パネルN+1の日付が既に「2025-01-02」である
- **THEN** パネルN+1の日付は変更されない（既に後の日付のため）

#### Scenario: カレンダー日付制限
- **WHEN** ユーザーがパネルNの日付ピッカーを開く
- **AND** パネルN-1に日付が設定されている
- **THEN** パネルN-1の日付より前の日付は選択不可になる

### Requirement: 場所キーワードに基づく絵文字自動設定
システムは、現在のアイコンがデフォルトの場合、場所キーワードに基づいて自動的に絵文字アイコンを提案しなければならない（SHALL）。

#### Scenario: 空港の場所に対する絵文字自動設定
- **WHEN** ユーザーが「airport」または「空港」を含む場所を設定する
- **AND** 現在のアイコンが📍（デフォルト）である
- **THEN** アイコンは自動的に✈️に変更される

#### Scenario: 駅の場所に対する絵文字自動設定
- **WHEN** ユーザーが「station」または「駅」を含む場所を設定する
- **AND** 現在のアイコンが📍（デフォルト）である
- **THEN** アイコンは自動的に🚃に変更される

#### Scenario: ホテルの場所に対する絵文字自動設定
- **WHEN** ユーザーが「hotel」または「ホテル」を含む場所を設定する
- **AND** 現在のアイコンが📍（デフォルト）である
- **THEN** アイコンは自動的に🏨に変更される

#### Scenario: カスタムアイコン設定時は自動設定しない
- **WHEN** ユーザーが「airport」を含む場所を設定する
- **AND** 現在のアイコンが🎉（ユーザー選択）である
- **THEN** アイコンは変更されない

### Requirement: 保存時に空パネルは自動削除される
意味のあるコンテンツがないパネルは、混乱を防ぐため保存時に自動的に削除されなければならない（SHALL）。

#### Scenario: 保存時に空パネルを削除
- **WHEN** ユーザーが旅程を保存する
- **AND** パネルNにタイトルも場所も設定されていない
- **THEN** パネルNは保存前に削除される
- **AND** トースト通知でユーザーに知らせる

#### Scenario: 場所のみのパネルは保持
- **WHEN** ユーザーが旅程を保存する
- **AND** パネルNにタイトルはないが場所が設定されている
- **THEN** パネルNは保持される

### Requirement: 日付タブによるアイテムフィルタリング
複数日の旅程の場合、ユーザーは日付タブを使ってアイテムをフィルタリングできなければならない（SHALL）。

#### Scenario: 日付タブの表示
- **WHEN** 旅程に複数日のアイテムがある
- **THEN** タイトル入力の下にタブバーが表示される
- **AND** 最初のタブは「全て」である
- **AND** 後続のタブは各ユニーク日付（12/31形式）である

#### Scenario: 日付タブでフィルタリング
- **WHEN** ユーザーが日付タブ（例：「12/31」）をクリックする
- **THEN** その日付のアイテムのみが表示される
- **AND** 「全て」をクリックすると全アイテムが再表示される

### Requirement: 金額入力フィールド
ユーザーは各旅程アイテムに任意で金額と通貨を入力できなければならない（SHALL）。

#### Scenario: 金額入力
- **WHEN** ユーザーがパネルを編集する
- **THEN** 任意の金額入力フィールドが利用可能である
- **AND** 通貨セレクター（JPY、USD、EUR）が利用可能である

#### Scenario: 金額の保存
- **WHEN** ユーザーが金額と通貨を入力する
- **AND** 旅程を保存する
- **THEN** 金額情報がアイテムとともに保存される

### Requirement: パネルUIのパディング縮小
モバイル画面スペースを最適化するため、パネルのパディングを縮小しなければならない（SHALL）。

#### Scenario: パディング縮小
- **WHEN** パネルが表示される
- **THEN** パネルのパディングはp-2（0.5rem）である
- **AND** 以前のp-4（1rem）から半減している
