# React + Vite Setup Guide

This document provides a quick reference for setting up the React + Vite project structure.

## Initial Setup Commands

```bash
# Create Vite project
npm create vite@latest bokutabi -- --template react-ts

# Navigate to project
cd bokutabi

# Install dependencies
npm install

# Install additional dependencies
npm install react-router-dom
npm install firebase
npm install @react-google-maps/api
npm install react-hook-form zod @hookform/resolvers
npm install date-fns
npm install react-i18next i18next i18next-browser-languagedetector
npm install -D tailwindcss postcss autoprefixer
npm install -D vite-plugin-pwa workbox-window

# Initialize Tailwind
npx tailwindcss init -p

# Initialize Firebase (if not using existing project)
npm install -g firebase-tools
firebase login
firebase init
```

## Project Structure

```
bokutabi/
├── public/
│   ├── icons/              # PWA icons (192x192, 512x512)
│   └── manifest.json       # PWA manifest (generated by vite-plugin-pwa)
├── src/
│   ├── components/         # React components
│   │   ├── common/         # Shared components (Button, Input, etc.)
│   │   ├── itinerary/      # Itinerary-specific components
│   │   └── map/            # Map-related components
│   ├── pages/              # Page components (routes)
│   │   ├── HomePage.tsx
│   │   ├── CreateItineraryPage.tsx
│   │   ├── ItineraryAuthPage.tsx
│   │   ├── ItineraryViewPage.tsx
│   │   └── SettingsPage.tsx
│   ├── hooks/              # Custom React hooks
│   │   ├── useAuth.ts
│   │   ├── useItinerary.ts
│   │   └── useTheme.ts
│   ├── lib/                # Utility functions and services
│   │   ├── firebase.ts     # Firebase config and initialization
│   │   ├── firestore.ts    # Firestore helper functions
│   │   ├── geocoding.ts    # Google Maps geocoding service
│   │   └── api.ts          # Cloud Functions API calls
│   ├── i18n/               # Internationalization
│   │   ├── config.ts       # i18next configuration
│   │   └── locales/
│   │       ├── ja.json     # Japanese translations
│   │       └── en.json     # English translations
│   ├── types/              # TypeScript type definitions
│   │   ├── itinerary.ts
│   │   └── user.ts
│   ├── context/            # React Context providers
│   │   ├── AuthContext.tsx
│   │   └── ThemeContext.tsx
│   ├── App.tsx             # Main App component with Router
│   ├── main.tsx            # Entry point
│   ├── index.css           # Global styles with Tailwind
│   └── vite-env.d.ts       # Vite type declarations
├── functions/              # Firebase Cloud Functions
│   ├── src/
│   │   ├── index.ts        # Cloud Functions entry point
│   │   ├── createItinerary.ts
│   │   ├── authenticateItinerary.ts
│   │   └── updatePassword.ts
│   ├── package.json
│   └── tsconfig.json
├── .env                    # Environment variables (VITE_ prefix)
├── .env.example            # Example env file
├── vite.config.ts          # Vite configuration
├── tailwind.config.js      # Tailwind configuration
├── tsconfig.json           # TypeScript configuration
├── firebase.json           # Firebase configuration
└── package.json
```

## vite.config.ts Example

```typescript
import { defineConfig } from 'vite'
import react from '@vitejs/plugin-react'
import { VitePWA } from 'vite-plugin-pwa'

export default defineConfig({
  plugins: [
    react(),
    VitePWA({
      registerType: 'autoUpdate',
      includeAssets: ['favicon.ico', 'robots.txt', 'icons/*.png'],
      manifest: {
        name: 'Travel Itinerary Planner',
        short_name: 'Bokutabi',
        description: 'Collaborative travel itinerary planning',
        theme_color: '#ffffff',
        background_color: '#ffffff',
        display: 'standalone',
        icons: [
          {
            src: 'icons/icon-192x192.png',
            sizes: '192x192',
            type: 'image/png'
          },
          {
            src: 'icons/icon-512x512.png',
            sizes: '512x512',
            type: 'image/png'
          }
        ]
      },
      workbox: {
        runtimeCaching: [
          {
            urlPattern: /^https:\/\/firestore\.googleapis\.com\/.*/i,
            handler: 'NetworkFirst',
            options: {
              cacheName: 'firestore-cache',
              expiration: {
                maxEntries: 100,
                maxAgeSeconds: 60 * 60 * 24 // 24 hours
              }
            }
          },
          {
            urlPattern: /^https:\/\/maps\.googleapis\.com\/.*/i,
            handler: 'CacheFirst',
            options: {
              cacheName: 'google-maps-cache',
              expiration: {
                maxEntries: 50,
                maxAgeSeconds: 60 * 60 * 24 * 30 // 30 days
              }
            }
          }
        ]
      }
    })
  ]
})
```

## React Router Setup (App.tsx)

```typescript
import { BrowserRouter, Routes, Route, Navigate } from 'react-router-dom';
import HomePage from './pages/HomePage';
import CreateItineraryPage from './pages/CreateItineraryPage';
import ItineraryAuthPage from './pages/ItineraryAuthPage';
import ItineraryViewPage from './pages/ItineraryViewPage';
import SettingsPage from './pages/SettingsPage';
import { AuthProvider } from './context/AuthContext';
import { ThemeProvider } from './context/ThemeContext';

function App() {
  return (
    <BrowserRouter>
      <ThemeProvider>
        <AuthProvider>
          <Routes>
            <Route path="/" element={<HomePage />} />
            <Route path="/create" element={<CreateItineraryPage />} />
            <Route path="/itinerary/:id/auth" element={<ItineraryAuthPage />} />
            <Route path="/itinerary/:id" element={<ItineraryViewPage />} />
            <Route path="/settings" element={<SettingsPage />} />
            <Route path="*" element={<Navigate to="/" replace />} />
          </Routes>
        </AuthProvider>
      </ThemeProvider>
    </BrowserRouter>
  );
}

export default App;
```

## Firebase Configuration

### firebase.json

```json
{
  "hosting": {
    "public": "dist",
    "ignore": [
      "firebase.json",
      "**/.*",
      "**/node_modules/**"
    ],
    "rewrites": [
      {
        "source": "**",
        "destination": "/index.html"
      }
    ]
  },
  "functions": {
    "source": "functions",
    "runtime": "nodejs18"
  },
  "firestore": {
    "rules": "firestore.rules",
    "indexes": "firestore.indexes.json"
  }
}
```

### .env Example

```
VITE_FIREBASE_API_KEY=your_api_key
VITE_FIREBASE_AUTH_DOMAIN=your_project.firebaseapp.com
VITE_FIREBASE_PROJECT_ID=your_project_id
VITE_FIREBASE_STORAGE_BUCKET=your_project.appspot.com
VITE_FIREBASE_MESSAGING_SENDER_ID=123456789
VITE_FIREBASE_APP_ID=1:123456789:web:abcdef

VITE_GOOGLE_MAPS_API_KEY=your_maps_api_key
VITE_CLOUD_FUNCTIONS_URL=https://us-central1-your_project_id.cloudfunctions.net
```

## Development Commands

```bash
# Start dev server
npm run dev

# Build for production
npm run build

# Preview production build
npm run preview

# Deploy to Firebase
firebase deploy

# Deploy only hosting
firebase deploy --only hosting

# Deploy only functions
firebase deploy --only functions

# Run Cloud Functions locally (emulator)
firebase emulators:start
```

## Key Differences from Next.js

| Feature | Next.js | React + Vite |
|---------|---------|--------------|
| **Routing** | File-based routing | React Router (code-based) |
| **API Routes** | Built-in API routes | Firebase Cloud Functions |
| **SSR/SSG** | Built-in | Not available (pure SPA) |
| **Build Tool** | Webpack | Vite (faster) |
| **Dev Server** | Next.js dev server | Vite dev server (very fast) |
| **Environment Variables** | `NEXT_PUBLIC_*` | `VITE_*` |
| **PWA** | next-pwa plugin | vite-plugin-pwa |
| **i18n** | next-intl | react-i18next |

## Benefits of Vite over Next.js for This Project

1. **Faster Development**: Vite's HMR is instant
2. **Simpler Architecture**: No SSR complexity, pure client-side
3. **Smaller Bundle**: No Next.js framework overhead
4. **Direct Firebase Integration**: Cloud Functions replace API routes seamlessly
5. **User Preference**: User requested React specifically

## Notes

- All routes are client-side (SPA behavior)
- Firebase Hosting serves the built React app
- Firebase Cloud Functions handle server-side logic (password hashing, auth)
- Firestore provides real-time data sync (no need for custom websockets)
- PWA works the same way as with Next.js (service worker + manifest)
